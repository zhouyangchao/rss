#include <stdint.h>

static const uint8_t default_rss_key[] = {
0x6d, 0x5a, 0x56, 0xda, 0x25, 0x5b, 0x0e, 0xc2,
0x41, 0x67, 0x25, 0x3d, 0x43, 0xa3, 0x8f, 0xb0,
0xd0, 0xca, 0x2b, 0xcb, 0xae, 0x7b, 0x30, 0xb4,
0x77, 0xcb, 0x2d, 0xa3, 0x80, 0x30, 0xf2, 0x0c,
0x6a, 0x42, 0xb7, 0x3b, 0xbe, 0xac, 0x01, 0xfa,
};

static inline uint32_t get_fast_mask(uint32_t idx, uint32_t offset)
{
    static const uint32_t rss_stream[8][37] = {
        { 0x6d5a56da, 0x5a56da25, 0x56da255b, 0xda255b0e, 0x255b0ec2, 0x5b0ec241, 0xec24167, 0xc2416725, 0x4167253d, 0x67253d43, 
          0x253d43a3, 0x3d43a38f, 0x43a38fb0, 0xa38fb0d0, 0x8fb0d0ca, 0xb0d0ca2b, 0xd0ca2bcb, 0xca2bcbae, 0x2bcbae7b, 0xcbae7b30, 
          0xae7b30b4, 0x7b30b477, 0x30b477cb, 0xb477cb2d, 0x77cb2da3, 0xcb2da380, 0x2da38030, 0xa38030f2, 0x8030f20c, 0x30f20c6a, 
          0x30f20c6a, 0xf20c6a42, 0xc6a42b7, 0x6a42b73b, 0x42b73bbe, 0xb73bbeac, 0x3bbeac01, 0xbeac01fa,},
        { 0xdab4adb4, 0xb4adb44a, 0xadb44ab6, 0xb44ab61d, 0x4ab61d84, 0xb61d8482, 0x1d8482ce, 0x8482ce4a, 0x82ce4a7a, 0xce4a7a87, 
          0x4a7a8747, 0x7a87471f, 0x87471f61, 0x471f61a1, 0x1f61a194, 0x61a19457, 0xa1945797, 0x9457975c, 0x57975cf6, 0x975cf661, 
          0x5cf66168, 0xf66168ef, 0x6168ef96, 0x68ef965b, 0xef965b47, 0x965b4700, 0x5b470061, 0x470061e4, 0x61e418, 0x61e418d4, 
          0xe418d485, 0x18d4856e, 0xd4856e77, 0x856e777d, 0x6e777d58, 0x777d5803, 0x7d5803f4,},
        { 0xb5695b68, 0x695b6895, 0x5b68956c, 0x68956c3b, 0x956c3b09, 0x6c3b0905, 0x3b09059c, 0x9059c94, 0x59c94f5, 0x9c94f50e, 
          0x94f50e8e, 0xf50e8e3e, 0xe8e3ec3, 0x8e3ec343, 0x3ec34328, 0xc34328af, 0x4328af2e, 0x28af2eb9, 0xaf2eb9ec, 0x2eb9ecc2, 
          0xb9ecc2d1, 0xecc2d1df, 0xc2d1df2c, 0xd1df2cb6, 0xdf2cb68e, 0x2cb68e00, 0xb68e00c3, 0x8e00c3c8, 0xc3c831, 0xc3c831a9, 
          0xc831a90a, 0x31a90adc, 0xa90adcee, 0xadceefa, 0xdceefab0, 0xeefab007, 0xfab007e8,},
        { 0x6ad2b6d1, 0xd2b6d12a, 0xb6d12ad8, 0xd12ad876, 0x2ad87612, 0xd876120b, 0x76120b39, 0x120b3929, 0xb3929ea, 0x3929ea1d, 
          0x29ea1d1c, 0xea1d1c7d, 0x1d1c7d86, 0x1c7d8686, 0x7d868651, 0x8686515e, 0x86515e5d, 0x515e5d73, 0x5e5d73d9, 0x5d73d985, 
          0x73d985a3, 0xd985a3be, 0x85a3be59, 0xa3be596d, 0xbe596d1c, 0x596d1c01, 0x6d1c0187, 0x1c018790, 0x1879063, 0x87906352, 
          0x90635215, 0x635215b9, 0x5215b9dd, 0x15b9ddf5, 0xb9ddf560, 0xddf5600f, 0xf5600fd0,},
        { 0xd5a56da2, 0xa56da255, 0x6da255b0, 0xa255b0ec, 0x55b0ec24, 0xb0ec2416, 0xec241672, 0x24167253, 0x167253d4, 0x7253d43a, 
          0x53d43a38, 0xd43a38fb, 0x3a38fb0d, 0x38fb0d0c, 0xfb0d0ca2, 0xd0ca2bc, 0xca2bcba, 0xa2bcbae7, 0xbcbae7b3, 0xbae7b30b, 
          0xe7b30b47, 0xb30b477c, 0xb477cb2, 0x477cb2da, 0x7cb2da38, 0xb2da3803, 0xda38030f, 0x38030f20, 0x30f20c6, 0xf20c6a4, 
          0x20c6a42b, 0xc6a42b73, 0xa42b73bb, 0x2b73bbea, 0x73bbeac0, 0xbbeac01f, 0xeac01fa0,},
        { 0xab4adb44, 0x4adb44ab, 0xdb44ab61, 0x44ab61d8, 0xab61d848, 0x61d8482c, 0xd8482ce4, 0x482ce4a7, 0x2ce4a7a8, 0xe4a7a874, 
          0xa7a87471, 0xa87471f6, 0x7471f61a, 0x71f61a19, 0xf61a1945, 0x1a194579, 0x19457975, 0x457975cf, 0x7975cf66, 0x75cf6616, 
          0xcf66168e, 0x66168ef9, 0x168ef965, 0x8ef965b4, 0xf965b470, 0x65b47006, 0xb470061e, 0x70061e41, 0x61e418d, 0x1e418d48, 
          0x418d4856, 0x8d4856e7, 0x4856e777, 0x56e777d5, 0xe777d580, 0x77d5803f, 0xd5803f40,},
        { 0x5695b689, 0x95b68956, 0xb68956c3, 0x8956c3b0, 0x56c3b090, 0xc3b09059, 0xb09059c9, 0x9059c94f, 0x59c94f50, 0xc94f50e8, 
          0x4f50e8e3, 0x50e8e3ec, 0xe8e3ec34, 0xe3ec3432, 0xec34328a, 0x34328af2, 0x328af2eb, 0x8af2eb9e, 0xf2eb9ecc, 0xeb9ecc2d, 
          0x9ecc2d1d, 0xcc2d1df2, 0x2d1df2cb, 0x1df2cb68, 0xf2cb68e0, 0xcb68e00c, 0x68e00c3c, 0xe00c3c83, 0xc3c831a, 0x3c831a90, 
          0x831a90ad, 0x1a90adce, 0x90adceef, 0xadceefab, 0xceefab00, 0xefab007e, 0xab007e80,},
        { 0xad2b6d12, 0x2b6d12ad, 0x6d12ad87, 0x12ad8761, 0xad876120, 0x876120b3, 0x6120b392, 0x20b3929e, 0xb3929ea1, 0x929ea1d1, 
          0x9ea1d1c7, 0xa1d1c7d8, 0xd1c7d868, 0xc7d86865, 0xd8686515, 0x686515e5, 0x6515e5d7, 0x15e5d73d, 0xe5d73d98, 0xd73d985a, 
          0x3d985a3b, 0x985a3be5, 0x5a3be596, 0x3be596d1, 0xe596d1c0, 0x96d1c018, 0xd1c01879, 0xc0187906, 0x18790635, 0x79063521, 
          0x635215b, 0x35215b9d, 0x215b9ddf, 0x5b9ddf56, 0x9ddf5600, 0xdf5600fd, 0x5600fd00,},
    };
    return rss_stream[offset][idx];
}
static inline uint32_t get_fast_mask2(uint32_t idx, uint32_t offset)
{
    static const uint32_t rss_stream[37][8] __attribute__((aligned(64))) = {
        {0x6d5a56da,0xdab4adb4,0xb5695b68,0x6ad2b6d1,0xd5a56da2,0xab4adb44,0x5695b689,0xad2b6d12,},
        {0x5a56da25,0xb4adb44a,0x695b6895,0xd2b6d12a,0xa56da255,0x4adb44ab,0x95b68956,0x2b6d12ad,},
        {0x56da255b,0xadb44ab6,0x5b68956c,0xb6d12ad8,0x6da255b0,0xdb44ab61,0xb68956c3,0x6d12ad87,},
        {0xda255b0e,0xb44ab61d,0x68956c3b,0xd12ad876,0xa255b0ec,0x44ab61d8,0x8956c3b0,0x12ad8761,},
        {0x255b0ec2,0x4ab61d84,0x956c3b09,0x2ad87612,0x55b0ec24,0xab61d848,0x56c3b090,0xad876120,},
        {0x5b0ec241,0xb61d8482,0x6c3b0905,0xd876120b,0xb0ec2416,0x61d8482c,0xc3b09059,0x876120b3,},
        {0x0ec24167,0x1d8482ce,0x3b09059c,0x76120b39,0xec241672,0xd8482ce4,0xb09059c9,0x6120b392,},
        {0xc2416725,0x8482ce4a,0x09059c94,0x120b3929,0x24167253,0x482ce4a7,0x9059c94f,0x20b3929e,},
        {0x4167253d,0x82ce4a7a,0x059c94f5,0x0b3929ea,0x167253d4,0x2ce4a7a8,0x59c94f50,0xb3929ea1,},
        {0x67253d43,0xce4a7a87,0x9c94f50e,0x3929ea1d,0x7253d43a,0xe4a7a874,0xc94f50e8,0x929ea1d1,},
        {0x253d43a3,0x4a7a8747,0x94f50e8e,0x29ea1d1c,0x53d43a38,0xa7a87471,0x4f50e8e3,0x9ea1d1c7,},
        {0x3d43a38f,0x7a87471f,0xf50e8e3e,0xea1d1c7d,0xd43a38fb,0xa87471f6,0x50e8e3ec,0xa1d1c7d8,},
        {0x43a38fb0,0x87471f61,0x0e8e3ec3,0x1d1c7d86,0x3a38fb0d,0x7471f61a,0xe8e3ec34,0xd1c7d868,},
        {0xa38fb0d0,0x471f61a1,0x8e3ec343,0x1c7d8686,0x38fb0d0c,0x71f61a19,0xe3ec3432,0xc7d86865,},
        {0x8fb0d0ca,0x1f61a194,0x3ec34328,0x7d868651,0xfb0d0ca2,0xf61a1945,0xec34328a,0xd8686515,},
        {0xb0d0ca2b,0x61a19457,0xc34328af,0x8686515e,0x0d0ca2bc,0x1a194579,0x34328af2,0x686515e5,},
        {0xd0ca2bcb,0xa1945797,0x4328af2e,0x86515e5d,0x0ca2bcba,0x19457975,0x328af2eb,0x6515e5d7,},
        {0xca2bcbae,0x9457975c,0x28af2eb9,0x515e5d73,0xa2bcbae7,0x457975cf,0x8af2eb9e,0x15e5d73d,},
        {0x2bcbae7b,0x57975cf6,0xaf2eb9ec,0x5e5d73d9,0xbcbae7b3,0x7975cf66,0xf2eb9ecc,0xe5d73d98,},
        {0xcbae7b30,0x975cf661,0x2eb9ecc2,0x5d73d985,0xbae7b30b,0x75cf6616,0xeb9ecc2d,0xd73d985a,},
        {0xae7b30b4,0x5cf66168,0xb9ecc2d1,0x73d985a3,0xe7b30b47,0xcf66168e,0x9ecc2d1d,0x3d985a3b,},
        {0x7b30b477,0xf66168ef,0xecc2d1df,0xd985a3be,0xb30b477c,0x66168ef9,0xcc2d1df2,0x985a3be5,},
        {0x30b477cb,0x6168ef96,0xc2d1df2c,0x85a3be59,0x0b477cb2,0x168ef965,0x2d1df2cb,0x5a3be596,},
        {0xb477cb2d,0x68ef965b,0xd1df2cb6,0xa3be596d,0x477cb2da,0x8ef965b4,0x1df2cb68,0x3be596d1,},
        {0x77cb2da3,0xef965b47,0xdf2cb68e,0xbe596d1c,0x7cb2da38,0xf965b470,0xf2cb68e0,0xe596d1c0,},
        {0xcb2da380,0x965b4700,0x2cb68e00,0x596d1c01,0xb2da3803,0x65b47006,0xcb68e00c,0x96d1c018,},
        {0x2da38030,0x5b470061,0xb68e00c3,0x6d1c0187,0xda38030f,0xb470061e,0x68e00c3c,0xd1c01879,},
        {0xa38030f2,0x470061e4,0x8e00c3c8,0x1c018790,0x38030f20,0x70061e41,0xe00c3c83,0xc0187906,},
        {0x8030f20c,0x0061e418,0x00c3c831,0x01879063,0x030f20c6,0x061e418d,0x0c3c831a,0x18790635,},
        {0x30f20c6a,0x61e418d4,0xc3c831a9,0x87906352,0x0f20c6a4,0x1e418d48,0x3c831a90,0x79063521,},
        {0xf20c6a42,0xe418d485,0xc831a90a,0x90635215,0x20c6a42b,0x418d4856,0x831a90ad,0x0635215b,},
        {0x0c6a42b7,0x18d4856e,0x31a90adc,0x635215b9,0xc6a42b73,0x8d4856e7,0x1a90adce,0x35215b9d,},
        {0x6a42b73b,0xd4856e77,0xa90adcee,0x5215b9dd,0xa42b73bb,0x4856e777,0x90adceef,0x215b9ddf,},
        {0x42b73bbe,0x856e777d,0x0adceefa,0x15b9ddf5,0x2b73bbea,0x56e777d5,0xadceefab,0x5b9ddf56,},
        {0xb73bbeac,0x6e777d58,0xdceefab0,0xb9ddf560,0x73bbeac0,0xe777d580,0xceefab00,0x9ddf5600,},
        {0x3bbeac01,0x777d5803,0xeefab007,0xddf5600f,0xbbeac01f,0x77d5803f,0xefab007e,0xdf5600fd,},
        {0xbeac01fa,0x7d5803f4,0xfab007e8,0xf5600fd0,0xeac01fa0,0xd5803f40,0xab007e80,0x5600fd00,},
    };
    return rss_stream[idx][offset];
}

